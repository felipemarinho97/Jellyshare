<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Jellyshare</title>
  </head>
  <body>
    <div
      id="JellyshareConfigPage"
      data-role="page"
      class="page type-interior pluginConfigurationPage"
      data-require="emby-input,emby-button,emby-select,emby-checkbox,emby-textarea"
    >
      <div data-role="content">
        <div class="content-primary">
          <form id="JellyshareConfigForm">
            <div class="inputContainer">
              <label class="inputLabel inputLabelUnfocused" for="RemoteServers">
                Remote Servers
              </label>
              <textarea
                id="RemoteServers"
                type="text"
                name="RemoteServers"
                rows="10"
                class="emby-input"
                is="emby-input"
              ></textarea>
            </div>

            <div>
              <button
                is="emby-button"
                type="submit"
                class="raised button-submit block emby-button"
              >
                <span>Save</span>
              </button>
            </div>
          </form>
        </div>
      </div>
      <script type="text/javascript">
        var TemplateConfig = {
          pluginUniqueId: "36700b7b-d95d-4082-821d-cf412466cc6b",
        };

        document
          .querySelector("#JellyshareConfigPage")
          .addEventListener("pageshow", function () {
            Dashboard.showLoadingMsg();
            ApiClient.getPluginConfiguration(
              TemplateConfig.pluginUniqueId
            ).then(function (config) {
              document.querySelector("#RemoteServers").value =
                config.RemoteServersRaw;
              Dashboard.hideLoadingMsg();
            });
          });

        document
          .querySelector("#JellyshareConfigForm")
          .addEventListener("submit", function (e) {
            Dashboard.showLoadingMsg();
            ApiClient.getPluginConfiguration(
              TemplateConfig.pluginUniqueId
            ).then(function (config) {
              config.RemoteServersRaw =
                document.querySelector("#RemoteServers").value;
              ApiClient.updatePluginConfiguration(
                TemplateConfig.pluginUniqueId,
                config
              ).then(function (result) {
                Dashboard.processPluginConfigurationUpdateResult(result);
              });
            });

            e.preventDefault();
            return false;
          });
      </script>
    </div>
  </body>
</html>
